# Микросервисы: принципы

### Основная часть

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры. Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

#### Задача 1: API Gateway

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:

    маршрутизация запросов к нужному сервису на основе конфигурации,
    возможность проверки аутентификационной информации в запросах,
    обеспечение терминации HTTPS.

Обоснуйте свой выбор.

#### Ответ

| Решение | Маршрутизация | Аутентификация |Терминация HTTPS|
|----------|----------|----------|----------|
| Kong Gateway    | + | + | + |
| Yandex Gateway    | + | + | + |
| Nginx    | + | + | + |

Все три решения подходят для выполнения задачи, однако я бы рекомендовал использовать Nginx, так как это доступное решение с большим комюнити и не стоящая на месте разработка, более того если в компании используется Nginx и в других проектах, это создаст дополнительную консистентность стека который используется в компании (не допущение зоопарка).
Мы можем использовать Nginx  для обеспечения терминации HTTPS, а также для маршрутизации запросов на разные сервисы на основе URI. Для каждого сервиса мы можем настроить проверку аутентификации, например, с использованием HTTP Basic Auth. Кроме того, в конфигурации мы  можем использовать SSL сертификат для обеспечения безопасного соединения по HTTPS. 

#### Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:

    поддержка кластеризации для обеспечения надёжности,
    хранение сообщений на диске в процессе доставки,
    высокая скорость работы,
    поддержка различных форматов сообщений,
    разделение прав доступа к различным потокам сообщений,
    простота эксплуатации.

Обоснуйте свой выбор.

#### Ответ

| Характеристики | Kafka | RabbitMQ | Redis |
|----------|----------|----------|----------|
| Поддержка кластеризации для обеспечения надежности | + | + | + |
| Хранение сообщений на диске в процессе доставки | + | + | - |
| Высокая скорость работы | + | + | + |
| Поддержка различных форматов сообщений | + | + | + |
| Разделение прав доступа к различным потокам сообщений | + | + | + |
| Простота эксплуатации | + | + | + |

Как видим для наших целей подходят два претендента Kafka и RabbitMQ, однако в большую компанию у которой тысячи пользователей на проектах на мой взгляд лучше использовать Kafka так как у этого брокера сообщений внушительные показатели по скорости, 1 миллион сообщений в секунду.Kafka основана на системе Publish/Subscribe.